---
import type { Project } from "../data/projects";
import type { Locale } from "../i18n";
import { pick } from "../i18n";

const { p, locale } = Astro.props as { p: Project; locale: Locale };
const basePath = locale === "fr" ? "/fr" : "/en";
const t =
  locale === "fr"
    ? {
        back: "Retour aux projets",
        highlights: "Points clés",
        links: "Liens",
        home: "Accueil",
        contact: "Contact",
      }
    : {
        back: "Back to work",
        highlights: "Highlights",
        links: "Links",
        home: "Home",
        contact: "Contact",
      };

const externalLinks = (p.links ?? []).filter((link) => link.href.startsWith("http"));
---

<section class="pb-14 pt-6" aria-labelledby="case-title">
  <a
    href={`${basePath}#work`}
    class="text-sm text-zinc-600 transition hover:text-zinc-900 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-4 focus-visible:outline-[rgb(var(--accent))]"
  >
    ← {t.back}
  </a>

  <div class="mt-6 rounded-3xl border border-zinc-200 bg-white p-8 shadow-sm">
    <div class="flex flex-wrap items-start justify-between gap-4">
      <div>
        <div class="inline-flex items-center gap-2 rounded-full border border-zinc-200 bg-zinc-50 px-3 py-1 text-xs text-zinc-700">
          <span class="h-1.5 w-1.5 rounded-full bg-[rgb(var(--accent))]"></span>
          {p.type}{p.year ? ` · ${p.year}` : ""} · {p.status}
        </div>

        <h1 id="case-title" class="mt-4 text-3xl font-semibold tracking-tight md:text-5xl md:leading-[1.1]">
          {pick(p.name, locale)}
        </h1>
        <p class="mt-4 max-w-2xl text-base leading-relaxed text-zinc-600 md:text-lg">
          {pick(p.oneLiner, locale)}
        </p>

        <div class="mt-6 flex flex-wrap gap-2 text-xs text-zinc-500">
          {p.tags.map((tag) => (
            <span class="rounded-full border border-zinc-200 bg-white px-3 py-1">{tag}</span>
          ))}
        </div>
      </div>
    </div>

    <div class="mt-8 overflow-hidden rounded-3xl border border-zinc-200 bg-zinc-50">
      {p.cover ? (
        <img src={p.cover} alt="" class="h-full w-full object-cover" loading="lazy" />
      ) : (
        <div class="aspect-[16/9] w-full bg-gradient-to-b from-zinc-100 via-white to-white"></div>
      )}
    </div>

    <div class="mt-10 grid gap-8 md:grid-cols-12">
      <div class="md:col-span-7">
        <h2 class="text-lg font-semibold tracking-tight">{t.highlights}</h2>
        <ul class="mt-4 space-y-3 text-zinc-700">
          {p.highlights[locale].map((h) => (
            <li class="flex gap-3">
              <span class="mt-2 h-1.5 w-1.5 shrink-0 rounded-full bg-[rgb(var(--accent))]"></span>
              <span>{h}</span>
            </li>
          ))}
        </ul>
      </div>

      <aside class="md:col-span-5">
        <div class="rounded-3xl border border-zinc-200 bg-white p-6">
          <h3 class="text-sm font-semibold tracking-tight text-zinc-900">{t.links}</h3>
          <div class="mt-3 flex flex-col gap-2 text-sm">
            <a
              class="rounded-xl border border-zinc-200 bg-white px-4 py-3 transition hover:border-zinc-300 hover:bg-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-4 focus-visible:outline-[rgb(var(--accent))]"
              href={basePath}
            >
              {t.home}
            </a>
            {externalLinks.map((link) => (
              <a
                class="rounded-xl border border-zinc-200 bg-white px-4 py-3 transition hover:border-zinc-300 hover:bg-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-4 focus-visible:outline-[rgb(var(--accent))]"
                href={link.href}
              >
                {pick(link.label, locale)}
              </a>
            ))}
            <a
              class="rounded-xl border border-zinc-200 bg-white px-4 py-3 transition hover:border-zinc-300 hover:bg-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-4 focus-visible:outline-[rgb(var(--accent))]"
              href={`${basePath}#contact`}
            >
              {t.contact}
            </a>
          </div>
        </div>
      </aside>
    </div>
  </div>
</section>
