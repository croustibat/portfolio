---
import type { Project } from "../data/projects";
import type { Locale } from "../i18n";
import { pick } from "../i18n";

const { p, locale, index = 0 } = Astro.props as { p: Project; locale: Locale; index?: number };
const viewLabel = locale === "fr" ? "Voir l'étude de cas" : "View case study";

// Stagger classes based on index (1-6)
const staggerClass = `stagger-${Math.min(index + 1, 6)}`;
---

<a
  href={`/${locale}/work/${p.slug}`}
  class={`animate-on-scroll ${staggerClass} card-glow spotlight-card group relative block overflow-hidden rounded-3xl border border-zinc-200 bg-white p-6 shadow-sm transition hover:-translate-y-0.5 hover:border-zinc-300 hover:shadow-md focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-4 focus-visible:outline-[rgb(var(--accent))]`}
>
  <div class="flex items-start justify-between gap-4">
    <div>
      <div class="inline-flex items-center gap-2 text-xs text-zinc-500">
        <span class="pulse-dot h-1.5 w-1.5 rounded-full bg-[rgb(var(--accent))]"></span>
        <span>{p.type}{p.year ? ` · ${p.year}` : ""}</span>
      </div>
      <h3 class="mt-3 text-lg font-semibold tracking-tight">{pick(p.name, locale)}</h3>
      <p class="mt-2 text-sm text-zinc-600">{pick(p.oneLiner, locale)}</p>
    </div>

    <span class="shrink-0 whitespace-nowrap rounded-full border border-zinc-200 bg-zinc-50 px-3 py-1 text-xs text-zinc-600">
      {p.status}
    </span>
  </div>

  <div class="mt-5 flex flex-wrap gap-2 text-xs text-zinc-500">
    {p.tags.slice(0, 4).map((t) => (
      <span class="rounded-full border border-zinc-200 px-3 py-1">{t}</span>
    ))}
  </div>

  <span class="mt-6 inline-flex items-center gap-2 text-sm font-medium text-zinc-900 transition group-hover:gap-2.5">
    {viewLabel}
    <span class="arrow-bounce">→</span>
  </span>

  {/* Spotlight glow that follows cursor */}
  <div class="spotlight-glow pointer-events-none absolute inset-0 opacity-0 transition-opacity duration-300 group-hover:opacity-100">
    <div class="spotlight-gradient absolute h-64 w-64 -translate-x-1/2 -translate-y-1/2 rounded-full bg-[rgb(var(--accent)/0.12)] blur-3xl"></div>
  </div>
</a>
